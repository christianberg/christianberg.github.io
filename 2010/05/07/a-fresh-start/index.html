<!DOCTYPE html>
<html><head><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Christian Berg" name="author"><link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet"><link href="/atom.xml" rel="alternate" title="Christian Bergs Blog" type="application/atom+xml"><title>Christian Bergs Blog</title></head><body><div class="navbar navbar-default"><div class="container"><div class="navbar-header"><a class="navbar-brand" href="/" title="{:author &quot;Christian Berg&quot;
 :type :blog}">(christianberg.github.io)</a></div><a class="navbar-text navbar-right" href="/archive">Archive</a></div></div><div class="container"><h1>A Fresh Start</h1><p>Since my last post a lot has happened in Clojure- and Compojure-Land. Managing dependencies and building projects is much easier now that there is <a href="http://github.com/technomancy/leiningen">Leiningen</a> and more people have played around with Clojure on Google App Engine, some are even deploying live apps (check out <a href="http://the-deadline.appspot.com/">TheDeadline</a>). </p><p>So I decided to build upon these great contributions and (finally) continue this little tutorial.</p>
<!--more--><h2>Create a new project</h2><p>From my last post, you can still read the part about Emacs, but you can forget about getting all the dependencies. We'll use Leiningen for that. To install Leiningen, follow the <a href="http://github.com/technomancy/leiningen">installation instructions</a>. Then create a new project:</p>
<pre><code class="shell">lein new compojureongae
</code></pre><p>This creates the basic directory structure with some skeleton code. Edit the project.clj file to look like this:</p>
<pre><code class="clojure">(defproject compojureongae &quot;0.1.0-SNAPSHOT&quot;
  :description &quot;Example app for deployoing Compojure on Google App Engine&quot;
  :dependencies [[compojure &quot;0.4.0-SNAPSHOT&quot;]
                 [ring/ring-jetty-adapter &quot;0.2.0&quot;]]
  :dev-dependencies [[leiningen/lein-swank &quot;1.1.0&quot;]])
</code></pre><p>I removed the direct dependencies on clojure and clojure-contrib, since depending on compojure automatically pulls these, but you could leave them in (e.g. if you need a specific version). The dev-dependency on lein-swank gives me integration with Emacs while letting Leiningen handle the classpath config.</p><p>Running <code>lein deps</code> (in the directory containing project.clj) downloads all required libraries and puts them in the lib directory.</p><h2>Start Hacking</h2><p>Run <code>lein swank</code> to start a REPL, open Emacs and enter <code>M-x slime-connect</code> to connect to the REPL. Now we can start hacking away in Emacs! Open <code>src/compojureongae/core.clj</code> and enter the following: </p>
<pre><code class="clojure">(ns compojureongae.core
  (:use compojure.core
        ring.adapter.jetty)
  (:require [compojure.route :as route]))

(defroutes example
  (GET &quot;/&quot; [] &quot;&lt;h1&gt;Hello World Wide Web!&lt;/h1&gt;&quot;)
  (route/not-found &quot;Page not found&quot;))

(run-jetty example {:port 8080})
</code></pre><p>(This is taken directly from Compojure's <a href="http://weavejester.github.com/compojure/docs/getting-started.html">Getting Started</a> page.) Pressing <code>C-c C-k</code> compiles the file and starts the server - you can see the output in the shell where you ran lein swank. Now browse to <a href="http://localhost:8080/">http://localhost:8080/</a> to see your first Compojure app.</p><p>Next step: Deploying this to Google App Engine!</p></div><footer><div class="container"><p class="text-muted"><small>&copy; 2009-2014 Christian Berg</small></p></div></footer><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-21431349-1', 'christianberg.github.io');
  ga('send', 'pageview');
</script></body></html>